(function(){tinymce.create("tinymce.plugins.TYVideo",{init:function(b,c){var a=null;b.addCommand("tyVideo",function(){a=b.selection.getBookmark(1);var f=b.id+"_tyvideo";var e=jQuery("#"+f);var d=jQuery("#"+b.id);TY.loader("TY.ui.videoV2",function(){TY.ui.video.prototype.mceClosePlugin=function(){this.hideUpload();tinymce.plugins.TYVideo.tyVar=null};tinymce.plugins.TYVideo.tyVar=new TY.ui.video({el:e.closest("td"),textarea:d,callback:function(i){if(i){var h=b.dom.createHTML("p",{},i.title);var g=i.flashUrl,k={type:"EmbeddedAudio",width:"640",height:"480",params:{src:g,allowscriptaccess:"always",quality:"high",wmode:"transparent",type:"application/x-shockwave-flash"},video:{sources:[]}};var j=tinymce.util.JSON.serialize(k,"'");h+=b.dom.createHTML("img",{"data-mce-src":b.baseURI.source+"/themes/advanced/img/trans.gif",src:b.baseURI.source+"/themes/advanced/img/trans.gif","class":"mceItemMedia mceItemEmbeddedAudio",width:"640",height:"480","data-mce-json":j});a&&b.selection.moveToBookmark(a);b.execCommand("mceInsertContent",false,h);a=null}},top:2,left:-33})})});b.addButton("tyvideo",{title:"插入视频",cmd:"tyVideo","class":"video"})},getInfo:function(){return{longname:"tyVideo",author:"wushufeng",authorurl:"http://www.tianya.cn",infourl:"http://www.tianya.cn",version:"1.0"}}});tinymce.PluginManager.add("tyvideo",tinymce.plugins.TYVideo)})();